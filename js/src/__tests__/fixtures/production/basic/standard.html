<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Standard Test</title>
    <style>
      html, body {
        height: 100%;
        margin: 0; /* remove default margin */
      }

      agent-standard {
        height: 100%;
        width: 100%;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        display: block; /* ensures it respects width/height */
      }

      /* Custom styles for hiding chat conversation */
    </style>
  </head>
  <body>
    <!-- Hero Section (initially visible) -->
    <div id="hero-section" style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      z-index: 10;
      transition: opacity 0.3s ease-in-out;
    ">
      <!-- Hero content -->
      <div style="flex: 1; display: flex; align-items: center; justify-content: center; padding: 2rem;">
        <div style="text-align: center; max-width: 500px; color: white;">
          <h1 style="font-size: 3rem; margin-bottom: 1rem; font-weight: 700;">Welcome!</h1>
          <p style="font-size: 1.2rem; margin-bottom: 2rem; opacity: 0.9; line-height: 1.6;">
            I'm your AI assistant, ready to help answer questions and provide support. 
            Click below to start our conversation.
          </p>
          <button 
            onclick="showChatConversation()" 
            style="
              background: rgba(255,255,255,0.2); 
              border: 2px solid white; 
              color: white; 
              padding: 1rem 2rem; 
              font-size: 1.1rem; 
              border-radius: 50px; 
              cursor: pointer; 
              transition: all 0.3s ease;
              backdrop-filter: blur(10px);
            "
            onmouseover="this.style.background='rgba(255,255,255,0.3)'"
            onmouseout="this.style.background='rgba(255,255,255,0.2)'"
          >
            Start Conversation
          </button>
        </div>
      </div>
      
      <!-- Space for real input (it will overlay here) -->
      <div style="height: 80px; pointer-events: none;"></div>
    </div>

    <script type="module">
      import Agent from 'https://cdn.jsdelivr.net/npm/@agent-embed/js@0.0.41/dist/web.js'
      Agent.initStandard({
        agentName: "Chatbot-1aeec",
        prefilledVariables: {
          user_id: "ab123",
          user_name: "John Doe",
          user_email: "john.doe@gmail.com",
          user_segments: ["sports", "ott"]
        },
        onSend: () => { 
          console.log('User sent message - showing conversation');
          window.showChatConversation();
        }
      });

      // Function to hide conversation while keeping input visible
      function hideConversation() {
        const agentStandard = document.querySelector('agent-standard');
        if (agentStandard && agentStandard.shadowRoot) {
          const chatContainer = agentStandard.shadowRoot.querySelector('.agent-embed-container > div:first-child');
          if (chatContainer) {
            chatContainer.style.display = 'none';
          }
        }
      }

      // Function to show conversation
      function showConversation() {
        const agentStandard = document.querySelector('agent-standard');
        if (agentStandard && agentStandard.shadowRoot) {
          const chatContainer = agentStandard.shadowRoot.querySelector('.agent-embed-container > div:first-child');
          if (chatContainer) {
            chatContainer.style.display = 'flex';
          }
        }
      }

      // Make showConversation globally accessible
      window.showConversation = showConversation;

      
      // Function to transition from hero to chat
      window.showChatConversation = function() {
        const heroSection = document.getElementById('hero-section');
        const resetButton = document.getElementById('reset-button');
        
        // Hide hero section
        heroSection.style.opacity = '0';
        setTimeout(() => {
          heroSection.style.display = 'none';
        }, 300);
        
        // Show chat conversation
        showConversation();
        
        // Show reset button
        resetButton.style.display = 'block';
      };
      
      // Add reset functionality
      window.resetChat = function() {
        if (window.Agent && window.Agent.reset) {
          window.Agent.reset();
        } else {
          console.error('Agent.reset is not available');
        }
        
        // Show hero section again 
        const heroSection = document.getElementById('hero-section');
        const resetButton = document.getElementById('reset-button');
        
        heroSection.style.display = 'flex';
        setTimeout(() => {
          heroSection.style.opacity = '1';
        }, 50);
        
        // Hide reset button
        resetButton.style.display = 'none';
      };
    </script>

    <agent-standard style="opacity: 1; transition: opacity 0.3s ease-in-out;"></agent-standard>
    
    <!-- Reset Button -->
    <button id="reset-button" onclick="resetChat()" style="
      position: fixed; 
      bottom: 20px; 
      right: 20px; 
      padding: 10px 20px; 
      background: #ff4444; 
      color: white; 
      border: none; 
      border-radius: 25px; 
      cursor: pointer;
      z-index: 20;
      font-size: 0.9rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transition: background 0.3s ease;
      display: none;
    " 
    onmouseover="this.style.background='#ff3333'" 
    onmouseout="this.style.background='#ff4444'">
      Back to Hero
    </button>

  </body>
</html>
